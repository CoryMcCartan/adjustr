<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>adjustr: Stan Model Adjustments and Sensitivity Analyses using Importance Sampling • adjustr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="adjustr: Stan Model Adjustments and Sensitivity Analyses using Importance Sampling">
<meta property="og:description" content="An R package which provides functions to help assess the sensitivity of a Bayesian model to the specification of its likelihood and priors. Users provide a series of alternate sampling specifications, and the package uses Pareto-smoothed importance sampling to estimate posterior quantities of interest under each specification. The package also provides functions to summarize and plot how these quantities change across specifications.
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-79274202-5"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-79274202-5');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">adjustr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/index.html">Vignettes</a>
</li>
<li>
  <a href="reference/index.html">Functions</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://mc-stan.org/rstan">rstan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/cmdstanr">cmdstanr</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstanarm">rstanarm</a>
    </li>
    <li>
      <a href="https://mc-stan.org/bayesplot">bayesplot</a>
    </li>
    <li>
      <a href="https://mc-stan.org/shinystan">shinystan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/loo">loo</a>
    </li>
    <li>
      <a href="https://mc-stan.org/projpred">projpred</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstantools">rstantools</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://mc-stan.org">Stan</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://twitter.com/mcmc_stan">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/CoryMcCartan/adjustr/">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://discourse.mc-stan.org/">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="adjustr" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#adjustr" class="anchor"></a>adjustr</h1></div>
<!-- badges: start -->

<p>Sensitivity analysis is a critical component of a good modeling workflow. Yet as the number and power of Bayesian computational tools has increased, the options for sensitivity analysis have remained largely the same: compute importance sampling weights manually, or fit a large number of similar models, dramatically increasing computation time. Neither option is satisfactory for most applied modeling.</p>
<p><strong>adjustr</strong> is an R package which aims to make sensitivity analysis faster and easier, and works with Bayesian models fitted with <a href="https://mc-stan.org">Stan</a>. Users provide a series of alternate sampling specifications, and the package uses Pareto-smoothed importance sampling to estimate the posterior under each specification. The package also provides functions to summarize and plot how posterior quantities quantities change across specifications.</p>
<p>The package provides simple interface that makes it as easy as possible for modellers to try out various adjustments to their Stan models, without needing to write any specific Stan code or even recompile or rerun their model.</p>
<p>The package works by parsing Stan model code, so everything works best if the model was written by the user. Models made using <strong>brms</strong> may in principle be used as well. Models made using <strong>rstanarm</strong> are constructed using more complex model templates, and cannot be used.</p>
<div id="getting-started" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting Started</h2>
<p>The basic <strong>adjustr</strong> workflow is as follows:</p>
<ol>
<li><p>Use <a href="https://corymccartan.github.io/adjustr/reference/make_spec.html"><code>make_spec</code></a> to specify the set of alternative model specifications you’d like to fit.</p></li>
<li><p>Use <a href="https://corymccartan.github.io/adjustr/reference/adjust_weights.html"><code>adjust_weights</code></a> to calculate importance sampling weights which approximate the posterior of each alternative specification.</p></li>
<li><p>Use <a href="https://corymccartan.github.io/adjustr/reference/summarize.adjustr_weighted.html"><code>summarize</code></a> and <a href="https://corymccartan.github.io/adjustr/reference/spec_plot.html"><code>spec_plot</code></a> to examine posterior quantities of interest for each alternative specification, in order to assess the sensitivity of the underlying model.</p></li>
</ol>
<p>To illustrate, the package lets us do the following:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/extract_samp_stmts.html">extract_samp_stmts</a></span><span class="op">(</span><span class="va">eightschools_m</span><span class="op">)</span>
<span class="co">#&gt; Sampling statements for model 2c8d1d8a30137533422c438f23b83428:</span>
<span class="co">#&gt;   parameter   eta ~ std_normal()</span>
<span class="co">#&gt;   data        y ~ normal(theta, sigma)</span>

<span class="fu"><a href="reference/make_spec.html">make_spec</a></span><span class="op">(</span><span class="va">eta</span> <span class="op">~</span> <span class="fu">student_t</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="va">df</span><span class="op">)</span>, df<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="reference/adjust_weights.html">adjust_weights</a></span><span class="op">(</span><span class="va">eightschools_m</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">summarize</span><span class="op">(</span><span class="fu">wasserstein</span><span class="op">(</span><span class="va">mu</span><span class="op">)</span><span class="op">)</span> 
<span class="co">#&gt; # A tibble: 11 x 5</span>
<span class="co">#&gt;       df .samp                     .weights      .pareto_k `wasserstein(mu)`</span>
<span class="co">#&gt;    &lt;int&gt; &lt;chr&gt;                     &lt;list&gt;            &lt;dbl&gt;             &lt;dbl&gt;</span>
<span class="co">#&gt;  1     1 eta ~ student_t(df, 0, 1) &lt;dbl [1,000]&gt;     1.02              0.928</span>
<span class="co">#&gt;  2     2 eta ~ student_t(df, 0, 1) &lt;dbl [1,000]&gt;     1.03              0.736</span>
<span class="co">#&gt;  3     3 eta ~ student_t(df, 0, 1) &lt;dbl [1,000]&gt;     0.915             0.534</span>
<span class="co">#&gt;  4     4 eta ~ student_t(df, 0, 1) &lt;dbl [1,000]&gt;     0.856             0.411</span>
<span class="co">#&gt;  5     5 eta ~ student_t(df, 0, 1) &lt;dbl [1,000]&gt;     0.826             0.341</span>
<span class="co">#&gt;  6     6 eta ~ student_t(df, 0, 1) &lt;dbl [1,000]&gt;     0.803             0.275</span>
<span class="co">#&gt;  7     7 eta ~ student_t(df, 0, 1) &lt;dbl [1,000]&gt;     0.782             0.234</span>
<span class="co">#&gt;  8     8 eta ~ student_t(df, 0, 1) &lt;dbl [1,000]&gt;     0.753             0.195</span>
<span class="co">#&gt;  9     9 eta ~ student_t(df, 0, 1) &lt;dbl [1,000]&gt;     0.736             0.166</span>
<span class="co">#&gt; 10    10 eta ~ student_t(df, 0, 1) &lt;dbl [1,000]&gt;     0.721             0.151</span>
<span class="co">#&gt; 11    NA &lt;original model&gt;          &lt;dbl [1,000]&gt;  -Inf                 0</span></code></pre></div>
<p>The tutorial <a href="https://corymccartan.github.io/adjustr/articles/eight-schools.html">vignette</a> walks through a full sensitivity analysis for this 8-schools example. Smaller examples are also included in the package <a href="https://corymccartan.github.io/adjustr/reference/index.html">documentation</a>.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install the latest version from <strong>GitHub</strong>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"corymccartan/adjustr@*release"</span><span class="op">)</span></code></pre></div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Vehtari, A., Simpson, D., Gelman, A., Yao, Y., &amp; Gabry, J. (2015). Pareto smoothed importance sampling. <em><a href="https://arxiv.org/abs/1507.02646">arXiv preprint arXiv:1507.02646</a></em>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/CoryMcCartan/adjustr/">https://​github.com/​CoryMcCartan/​adjustr/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/CoryMcCartan/adjustr/issues">https://​github.com/​CoryMcCartan/​adjustr/​issues</a>
</li>
<li>Ask a question at <br><a href="https://discourse.mc-stan.org/">https://​discourse.mc-stan.org/​</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://corymccartan.github.io/">Cory McCartan</a> <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.tidyverse.org/lifecycle/#experimental"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://github.com/CoryMcCartan/adjustr/actions"><img src="https://github.com/CoryMcCartan/adjustr/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://codecov.io/gh/CoryMcCartan/adjustr?branch=master"><img src="https://codecov.io/gh/CoryMcCartan/adjustr/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://corymccartan.github.io/">Cory McCartan</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
